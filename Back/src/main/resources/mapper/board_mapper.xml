<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.fitime.board.BoardDAO">

	<insert id="insertBoard" parameterType="com.fitime.dto.BoardDTO">
		INSERT INTO board
		(board_idx, user_id, title, content,
		reg_date, category,
		file_name)
		VALUES (#{boardIdx}, #{userId}, #{title},
		#{content}, NOW(),
		#{category},
		#{fileName})
	</insert>

	<select id="selectBoardById" parameterType="int"
		resultType="com.fitime.dto.BoardDTO">
		SELECT * FROM board WHERE board_idx = #{boardIdx}
	</select>

	<select id="selectBoardList" resultType="BoardDTO">
		SELECT * FROM board WHERE status = 'active' ORDER BY board_idx DESC
	</select>

	<update id="updateBoard" parameterType="com.fitime.dto.BoardDTO">
		UPDATE board
		SET title =
		#{title}, content = #{content},
		category = #{category}
		WHERE board_idx =
		#{boardIdx}
	</update>

	<update id="softDeleteBoard" parameterType="int">
		UPDATE board SET
		status = 'deleted' WHERE board_idx = #{boardIdx}
	</update>

	<insert id="boardInsert" parameterType="com.fitime.dto.BoardDTO"
		useGeneratedKeys="true" keyProperty="boardIdx">
		INSERT INTO board (user_id, title,
		content, reg_date,
		category, file_name)
		VALUES (#{userId}, #{title},
		#{content}, NOW(),
		#{category},
		#{fileName})
	</insert>

	<select id="listWithPaging" resultType="com.fitime.dto.BoardDTO">
		SELECT * FROM board
		ORDER
		BY board_idx DESC
		LIMIT #{offset}, #{size}
	</select>

	<select id="getTotalCount" resultType="int">
		SELECT COUNT(*) FROM board
	</select>

	<insert id="insertFile">
		INSERT INTO board_file (board_idx, file_name)
		VALUES
		(#{boardIdx}, #{fileName})
	</insert>

	<select id="selectFileNames" parameterType="int"
		resultType="String">
		SELECT file_name FROM board_file WHERE board_idx =
		#{boardIdx}
	</select>

	<select id="searchBoard" parameterType="String"
		resultType="com.fitime.dto.BoardDTO">
		SELECT * FROM board
		WHERE title LIKE CONCAT('%', #{keyword},
		'%')
		OR content LIKE CONCAT('%', #{keyword}, '%')
		ORDER BY board_idx
		DESC
	</select>

</mapper>
